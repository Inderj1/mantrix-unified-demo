@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .
@prefix copa: <http://mantrix.ai/ontology/copa#> .
@prefix mantrix: <http://mantrix.ai/ontology#> .

copa:metric_gross_margin a mantrix:Metric ;
    rdfs:label "Gross Margin" ;
    rdfs:comment "Gross sales plus COGS (COGS is negative). Measures production profitability." ;
    skos:altLabel "gross profit" , "GM" , "gross income" ;
    mantrix:sqlFormula "SUM(Gross_Sales) + SUM(Total_COGS)" ;
    mantrix:exampleSQL "SELECT SUM(Gross_Sales) + SUM(Total_COGS) as gross_margin FROM dataset_25m_table" ;
    mantrix:edgeCases "Cost columns are stored as NEGATIVE values. Use SUM(Gross_Sales) + SUM(Total_COGS) — addition, not subtraction. NEVER use Gross_Revenue — use Gross_Sales." .

copa:metric_gross_margin_pct a mantrix:Metric ;
    rdfs:label "Gross Margin %" ;
    rdfs:comment "Gross margin as percentage of gross sales." ;
    skos:altLabel "GM%" , "gross profit margin" , "GPM" ;
    mantrix:sqlFormula "(SUM(Gross_Sales) + SUM(Total_COGS)) / NULLIF(SUM(Gross_Sales), 0) * 100" ;
    mantrix:exampleQuestion "Gross margin % by brand" ;
    mantrix:exampleSQL "SELECT Brand, (SUM(Gross_Sales) + SUM(Total_COGS)) / NULLIF(SUM(Gross_Sales), 0) * 100 as gm_pct FROM dataset_25m_table GROUP BY Brand ORDER BY gm_pct DESC" .
