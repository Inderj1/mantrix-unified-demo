@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .
@prefix copa: <http://mantrix.ai/ontology/copa#> .
@prefix mantrix: <http://mantrix.ai/ontology#> .

copa:dim_product a mantrix:Dimension ;
    rdfs:label "Product" ;
    rdfs:comment "Product dimension. Material_Number is the unique ID. Material_Name is the description. Products belong to Brands." ;
    skos:altLabel "material" , "SKU" , "item" , "article" , "product" ;
    mantrix:bqColumns "Material_Number, Material_Name, Brand" ;
    mantrix:exampleQuestion "Revenue by product" ;
    mantrix:exampleSQL "SELECT Material_Name, SUM(Net_Sales) as revenue, SUM(Inv_Quantity) as units FROM dataset_25m_table GROUP BY Material_Name ORDER BY revenue DESC LIMIT 20" ;
    mantrix:exampleQuestion "Products with lowest margin" ;
    mantrix:exampleSQL """SELECT Material_Name, SUM(Net_Sales) as revenue, SUM(Cogs) as cogs,
  (SUM(Net_Sales) - SUM(Cogs)) / NULLIF(SUM(Net_Sales), 0) * 100 as margin_pct
FROM dataset_25m_table GROUP BY Material_Name
HAVING SUM(Net_Sales) > 0 ORDER BY margin_pct ASC LIMIT 10""" .
