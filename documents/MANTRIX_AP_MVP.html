<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MANTRIX AP ‚Äî Thales DSI</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700;0,9..40,800&family=IBM+Plex+Mono:wght@400;500;600;700&display=swap');
:root{--bg:#F6F7FB;--surface:#FFF;--s2:#F0F1F6;--s3:#E8EAF0;--brd:#E0E3EB;--brd2:#CDD1DC;--brdL:#ECEEF4;--t:#111827;--t2:#374151;--t3:#6B7280;--t4:#9CA3AF;--teal:#0D9488;--tealBg:rgba(13,148,136,.06);--tealBr:rgba(13,148,136,.18);--blue:#2563EB;--blueBg:rgba(37,99,235,.06);--blueBr:rgba(37,99,235,.15);--amber:#D97706;--amberBg:rgba(217,119,6,.07);--amberBr:rgba(217,119,6,.15);--red:#DC2626;--redBg:rgba(220,38,38,.06);--redBr:rgba(220,38,38,.12);--green:#059669;--greenBg:rgba(5,150,105,.06);--greenBr:rgba(5,150,105,.15);--purple:#7C3AED;--purpleBg:rgba(124,58,237,.06);--purpleBr:rgba(124,58,237,.12);--orange:#EA580C;--orangeBg:rgba(234,88,12,.06);--orangeBr:rgba(234,88,12,.15);--slate:#475569;--slateBg:rgba(71,85,105,.06);--slateBr:rgba(71,85,105,.15)}
*{margin:0;padding:0;box-sizing:border-box}body{font-family:'DM Sans',sans-serif;background:var(--bg);color:var(--t);line-height:1.5;-webkit-font-smoothing:antialiased;font-size:12px}
.nav{display:flex;align-items:center;justify-content:space-between;padding:0 24px;height:48px;background:var(--surface);border-bottom:1px solid var(--brd);position:sticky;top:0;z-index:100}.nav-l{display:flex;align-items:center;gap:20px}.logo{font-family:'IBM Plex Mono',monospace;font-size:13px;font-weight:700;color:var(--teal);letter-spacing:.5px}.logo span{color:var(--t4);font-weight:400}.tabs{display:flex;gap:2px}.tab{font-size:12px;padding:6px 14px;border-radius:8px;color:var(--t3);font-weight:500;cursor:pointer;transition:.15s;border:1px solid transparent;user-select:none}.tab:hover{background:var(--s2);color:var(--t2)}.tab.on{background:var(--tealBg);color:var(--teal);font-weight:600;border-color:var(--tealBr)}.badge{display:inline-flex;align-items:center;justify-content:center;min-width:16px;height:16px;border-radius:100px;font-size:8px;font-weight:700;margin-left:4px;padding:0 4px;font-family:'IBM Plex Mono',monospace}.nav-r{display:flex;align-items:center;gap:10px}.org{font-size:10px;color:var(--t3)}.av{width:28px;height:28px;border-radius:50%;background:linear-gradient(135deg,var(--teal),var(--blue));display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:700;color:#fff}.sap-link{font-family:'IBM Plex Mono',monospace;font-size:9px;padding:4px 10px;border-radius:6px;border:1px solid var(--tealBr);color:var(--teal);text-decoration:none;font-weight:600;background:var(--tealBg);cursor:pointer}
.v{display:none;animation:fi .2s ease}.v.on{display:block}@keyframes fi{from{opacity:0;transform:translateY(4px)}to{opacity:1;transform:none}}
.kpi-bar{display:flex;align-items:center;padding:12px 24px;background:var(--surface);border-bottom:1px solid var(--brd)}.kpi-g{display:flex;gap:28px}.kpi{text-align:center}.kpi-n{font-family:'IBM Plex Mono',monospace;font-size:22px;font-weight:700;line-height:1.2}.kpi-l{font-size:8px;color:var(--t4);text-transform:uppercase;letter-spacing:1px;font-weight:600;margin-top:1px}
/* ‚ïê‚ïê‚ïê CHANNEL STRIP ‚ïê‚ïê‚ïê */
.ch-strip{display:grid;grid-template-columns:repeat(4,1fr);gap:0;background:var(--surface);border-bottom:2px solid var(--brd)}.ch-card{padding:12px 16px;border-right:1px solid var(--brdL);cursor:pointer;transition:.15s}.ch-card:last-child{border-right:none}.ch-card:hover{background:var(--tealBg)}.ch-card.on{background:var(--tealBg);box-shadow:inset 0 -3px 0 var(--teal)}.ch-top{display:flex;align-items:center;justify-content:space-between;margin-bottom:4px}.ch-icon{font-size:18px}.ch-tag{font-family:'IBM Plex Mono',monospace;font-size:7px;font-weight:700;padding:2px 6px;border-radius:3px;text-transform:uppercase;letter-spacing:.5px}.ch-tag.all{background:var(--tealBg);color:var(--teal);border:1px solid var(--tealBr)}.ch-tag.email{background:var(--blueBg);color:var(--blue);border:1px solid var(--blueBr)}.ch-tag.edi{background:var(--greenBg);color:var(--green);border:1px solid var(--greenBr)}.ch-tag.portal{background:var(--purpleBg);color:var(--purple);border:1px solid var(--purpleBr)}.ch-count{font-family:'IBM Plex Mono',monospace;font-size:24px;font-weight:700;line-height:1.1}.ch-label{font-family:'IBM Plex Mono',monospace;font-size:8px;color:var(--t4);text-transform:uppercase;letter-spacing:.8px;font-weight:600;margin-top:1px}.ch-val{font-family:'IBM Plex Mono',monospace;font-size:10px;font-weight:600;color:var(--t3);margin-top:2px}.ch-bar{display:flex;gap:2px;margin-top:4px;height:4px;border-radius:2px;overflow:hidden}.ch-seg{border-radius:2px;height:100%}.ch-stats{display:flex;gap:8px;margin-top:3px;font-size:8px;font-family:'IBM Plex Mono',monospace}.ch-s-ok{color:var(--green);font-weight:600}.ch-s-w{color:var(--amber);font-weight:600}.ch-s-e{color:var(--red);font-weight:600}.ch-desc{font-size:8px;color:var(--t4);margin-top:2px}
.ch-b{font-family:'IBM Plex Mono',monospace;font-size:7px;font-weight:700;padding:2px 5px;border-radius:3px;display:inline-flex;align-items:center;gap:3px;white-space:nowrap}.ch-b.email{background:var(--blueBg);color:var(--blue);border:1px solid var(--blueBr)}.ch-b.edi{background:var(--greenBg);color:var(--green);border:1px solid var(--greenBr)}.ch-b.portal{background:var(--purpleBg);color:var(--purple);border:1px solid var(--purpleBr)}
.fbar{display:flex;align-items:center;justify-content:space-between;padding:8px 24px;border-bottom:1px solid var(--brdL);background:var(--surface)}.fg{display:flex;gap:3px}.fc{font-family:'IBM Plex Mono',monospace;font-size:9px;padding:4px 10px;border-radius:6px;border:1px solid var(--brd);background:var(--surface);color:var(--t4);cursor:pointer;font-weight:500}.fc.on{background:var(--tealBg);color:var(--teal);border-color:var(--tealBr)}.sbox{font-family:'IBM Plex Mono',monospace;font-size:10px;padding:4px 12px;border-radius:6px;border:1px solid var(--brd);background:var(--surface);color:var(--t3);width:180px;outline:none}
.slbl{padding:6px 24px;background:var(--s2);font-family:'IBM Plex Mono',monospace;font-size:8px;color:var(--t4);letter-spacing:1.5px;text-transform:uppercase;font-weight:600;border-bottom:1px solid var(--brdL)}
.it{background:var(--surface)}.ir{display:grid;grid-template-columns:10px 40px 1fr 110px 48px 44px 240px;gap:10px;align-items:center;padding:11px 24px;border-bottom:1px solid var(--brdL);cursor:pointer;transition:.12s}.ir:hover{background:rgba(13,148,136,.02)}.ir.sel{background:var(--tealBg);border-left:3px solid var(--teal);padding-left:21px}
.cd{width:9px;height:9px;border-radius:50%}.cd.g{background:var(--green);box-shadow:0 0 0 3px var(--greenBg)}.cd.a{background:var(--amber);box-shadow:0 0 0 3px var(--amberBg)}.cd.r{background:var(--red);box-shadow:0 0 0 3px var(--redBg)}.cd.p{background:var(--t4);animation:pu 1.5s ease infinite}@keyframes pu{0%,100%{opacity:.4}50%{opacity:1}}
.lb{font-family:'IBM Plex Mono',monospace;font-size:10px;color:var(--t3);text-align:center;background:var(--s2);padding:3px 6px;border-radius:5px;font-weight:600}.lb.many{color:var(--amber);background:var(--amberBg)}.iv{font-size:12px;font-weight:600}.im{font-size:9px;color:var(--t4);margin-top:1px;display:flex;align-items:center;gap:6px;flex-wrap:wrap}.ia{font-family:'IBM Plex Mono',monospace;font-size:12px;font-weight:700;text-align:right}.itp{font-family:'IBM Plex Mono',monospace;font-size:8px;font-weight:600;text-align:center;padding:2px 6px;border-radius:4px}.itp.po{background:var(--blueBg);color:var(--blue)}.itp.np{background:var(--purpleBg);color:var(--purple)}.is{font-family:'IBM Plex Mono',monospace;font-size:12px;font-weight:700;text-align:center}.ii{font-size:9px;color:var(--t3);line-height:1.4}.ii strong{color:var(--t2)}.tg{font-weight:600}.tg.ok{color:var(--green)}.tg.w{color:var(--amber)}.tg.e{color:var(--red)}.tg.d{color:var(--purple)}.tg.o{color:var(--orange)}
.ir.proc{opacity:.55;cursor:default}.pb{display:flex;align-items:center;gap:6px}.pt{flex:1;height:3px;background:var(--s3);border-radius:2px;overflow:hidden;max-width:80px}.pf{height:100%;border-radius:2px;background:linear-gradient(90deg,var(--teal),var(--blue))}.ps{font-family:'IBM Plex Mono',monospace;font-size:8px;color:var(--teal)}
/* WORKBENCH */
.wb-top{display:flex;align-items:center;justify-content:space-between;padding:8px 20px;background:var(--surface);border-bottom:1px solid var(--brd)}.wb-bk{font-size:10px;color:var(--t3);cursor:pointer;padding:4px 10px;border:1px solid var(--brd);border-radius:6px;font-weight:500}.wb-bk:hover{border-color:var(--tealBr);color:var(--teal);background:var(--tealBg)}.wb-v{font-size:15px;font-weight:700}.wb-m{font-family:'IBM Plex Mono',monospace;font-size:9px;color:var(--t3)}.wb-a{font-family:'IBM Plex Mono',monospace;font-size:18px;font-weight:700}
.wb-p{display:grid;grid-template-columns:200px 1fr 280px;height:calc(100vh - 100px);background:var(--bg)}.wp{overflow-y:auto;background:var(--surface)}.wp-l{border-right:1px solid var(--brd);padding:10px}.wp-c{border-right:1px solid var(--brd)}.wp-r{background:var(--s2);padding:12px;overflow-y:auto}
.wt{font-family:'IBM Plex Mono',monospace;font-size:8px;color:var(--t4);text-transform:uppercase;letter-spacing:1.2px;font-weight:600;margin-bottom:6px}
.pdf-c{background:var(--s2);border:1px solid var(--brd);border-radius:8px;padding:20px 10px;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;position:relative;overflow:hidden;min-height:120px}.pdf-c::before{content:'';position:absolute;inset:0;background:repeating-linear-gradient(0deg,transparent,transparent 18px,var(--brdL) 18px,var(--brdL) 19px);opacity:.4}.pdf-c>*{position:relative;z-index:1}
.ev-row{display:flex;justify-content:space-between;padding:3px 0;font-size:8px;border-bottom:1px solid var(--brdL)}.ev-l{color:var(--t3)}.ev-v{font-family:'IBM Plex Mono',monospace;font-weight:600;font-size:8px;display:flex;align-items:center;gap:3px}.ev-v.ok{color:var(--green)}.ev-v.e{color:var(--red)}.ev-dot{width:4px;height:4px;border-radius:50%}.ev-dot.h{background:var(--green)}.ev-dot.l{background:var(--red)}
.hdr-bar{display:flex;flex-wrap:wrap;gap:6px;padding:8px 12px;background:var(--surface);border-bottom:1px solid var(--brd)}.hf-grp{display:flex;flex-direction:column;gap:1px}.hf-l{font-family:'IBM Plex Mono',monospace;font-size:6px;color:var(--t4);text-transform:uppercase;letter-spacing:.5px;font-weight:600}.hf-inp{font-family:'IBM Plex Mono',monospace;font-size:10px;font-weight:600;padding:3px 6px;border:1px solid var(--tealBr);border-radius:3px;background:var(--tealBg);color:var(--teal);outline:none;min-width:70px}.hf-inp:focus{border-color:var(--teal)}.hf-inp.lock{background:var(--s2);color:var(--t3);border-color:var(--brd);cursor:default}
.vrd-bar{display:flex;gap:4px;padding:6px 12px;background:var(--surface);border-bottom:1px solid var(--brdL);flex-wrap:wrap}.vrd{display:flex;align-items:center;gap:4px;padding:3px 8px;border-radius:5px;font-size:9px;font-weight:500}.vrd.ok{background:var(--greenBg);color:var(--green)}.vrd.w{background:var(--amberBg);color:var(--amber)}.vrd.e{background:var(--redBg);color:var(--red)}.vrd.d{background:var(--purpleBg);color:var(--purple)}
.grid-toolbar{display:flex;align-items:center;justify-content:space-between;padding:5px 12px;background:var(--s2);border-bottom:1px solid var(--brd)}.gt-l{font-family:'IBM Plex Mono',monospace;font-size:8px;font-weight:600;color:var(--t3)}.gt-r{display:flex;gap:3px}.gt-btn{font-family:'IBM Plex Mono',monospace;font-size:7px;padding:3px 8px;border-radius:3px;border:1px solid var(--brd);background:var(--surface);color:var(--t3);cursor:pointer;font-weight:600}.gt-btn:hover{border-color:var(--tealBr);color:var(--teal);background:var(--tealBg)}
.grid-wrap{overflow-x:auto;overflow-y:auto;background:var(--surface);max-height:calc(100vh - 280px)}.g-tbl{width:100%;border-collapse:collapse;font-size:10px}.g-tbl th{font-family:'IBM Plex Mono',monospace;font-size:7px;text-transform:uppercase;letter-spacing:.6px;font-weight:600;color:var(--t4);padding:5px 6px;text-align:left;background:var(--s2);border-bottom:1px solid var(--brd);position:sticky;top:0;white-space:nowrap;z-index:2}.g-tbl th.r{text-align:right}.g-tbl td{padding:4px 6px;border-bottom:1px solid var(--brdL);vertical-align:middle}.g-tbl tr:hover{background:rgba(13,148,136,.02)}.g-tbl tr.row-ok{border-left:3px solid var(--green)}.g-tbl tr.row-w{border-left:3px solid var(--amber)}.g-tbl tr.row-e{border-left:3px solid var(--red)}.g-tbl tr.row-gl{border-left:3px solid var(--purple);background:rgba(124,58,237,.02)}
.gc{font-family:'IBM Plex Mono',monospace;font-size:9px;font-weight:500;padding:2px 4px;border:1px solid var(--tealBr);border-radius:3px;background:var(--tealBg);color:var(--teal);outline:none;width:100%;text-align:right}.gc:focus{border-color:var(--teal)}.gc.txt{text-align:left;min-width:90px}.gc.sm{width:50px}.gc.med{width:70px}.gc.lg{width:85px}
.gc-ro{font-family:'IBM Plex Mono',monospace;font-size:9px;color:var(--t2);white-space:nowrap}
.gc-sel{font-family:'IBM Plex Mono',monospace;font-size:8px;padding:2px 3px;border:1px solid var(--tealBr);border-radius:3px;background:var(--tealBg);color:var(--teal);outline:none;cursor:pointer;max-width:90px}
.mb{font-family:'IBM Plex Mono',monospace;font-size:7px;font-weight:700;padding:2px 5px;border-radius:3px;text-align:center;white-space:nowrap}.mb.ok{background:var(--greenBg);color:var(--green)}.mb.v{background:var(--amberBg);color:var(--amber)}.mb.m{background:var(--redBg);color:var(--red)}.mb.gl{background:var(--purpleBg);color:var(--purple)}
/* Line type badge */
.lt{font-family:'IBM Plex Mono',monospace;font-size:6px;font-weight:700;padding:1px 4px;border-radius:2px;white-space:nowrap}.lt.po{background:var(--blueBg);color:var(--blue);border:1px solid var(--blueBr)}.lt.gl{background:var(--purpleBg);color:var(--purple);border:1px solid var(--purpleBr)}
.split-btn{font-family:'IBM Plex Mono',monospace;font-size:7px;padding:2px 5px;border-radius:3px;border:1px dashed var(--tealBr);background:transparent;color:var(--teal);cursor:pointer;font-weight:600}.split-btn:hover{background:var(--tealBg)}
.gl-sect{padding:8px 12px;border-top:1px solid var(--brd)}.gl-title{font-family:'IBM Plex Mono',monospace;font-size:8px;color:var(--t4);text-transform:uppercase;letter-spacing:1px;font-weight:600;margin-bottom:4px}
.rc{background:var(--amberBg);border:1px solid var(--amberBr);border-radius:6px;padding:8px 10px;margin:6px 12px}.rc-l{font-family:'IBM Plex Mono',monospace;font-size:7px;color:var(--amber);font-weight:700;text-transform:uppercase;letter-spacing:1px;margin-bottom:3px}.rc-t{font-size:9px;color:var(--t2);line-height:1.5}.rc-t strong{color:var(--t)}
.timeline{display:flex;align-items:center;gap:0;margin-bottom:8px;padding:8px;background:var(--surface);border:1px solid var(--brd);border-radius:8px}.tl-step{display:flex;flex-direction:column;align-items:center;flex:1}.tl-dot{width:16px;height:16px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:8px;font-weight:700;border:2px solid var(--brd);background:var(--surface);color:var(--t4);z-index:1}.tl-dot.done{border-color:var(--green);background:var(--green);color:#fff}.tl-dot.current{border-color:var(--teal);background:var(--tealBg);color:var(--teal)}.tl-label{font-family:'IBM Plex Mono',monospace;font-size:5.5px;color:var(--t4);text-transform:uppercase;letter-spacing:.3px;font-weight:600;margin-top:2px;text-align:center;white-space:nowrap}.tl-label.current{color:var(--teal)}.tl-label.done{color:var(--green)}.tl-line{flex:1;height:2px;background:var(--brdL);margin:0 -2px;position:relative;top:-12px}.tl-line.done{background:var(--green)}
.appr-box{border:1px solid var(--brd);border-radius:6px;padding:7px 8px;margin-bottom:8px;font-size:9px}.appr-box.needed{border-color:var(--amberBr);background:var(--amberBg)}.appr-box.no{border-color:var(--greenBr);background:var(--greenBg)}.appr-title{font-family:'IBM Plex Mono',monospace;font-size:7px;font-weight:700;text-transform:uppercase;letter-spacing:1px;margin-bottom:2px}.appr-title.needed{color:var(--amber)}.appr-title.no{color:var(--green)}.appr-reason{font-size:8px;color:var(--t2);line-height:1.4}.appr-who{font-family:'IBM Plex Mono',monospace;font-size:8px;color:var(--t3);margin-top:2px}
.save-group{display:flex;gap:4px;margin-bottom:6px}.btn-save{flex:1;padding:7px;border:1px solid var(--brd);border-radius:6px;font-family:'IBM Plex Mono',monospace;font-size:9px;font-weight:600;cursor:pointer;text-align:center;background:var(--surface);color:var(--t3)}.btn-save:hover{border-color:var(--tealBr);color:var(--teal)}.btn-submit{flex:2;padding:7px;border:none;border-radius:6px;font-family:'IBM Plex Mono',monospace;font-size:9px;font-weight:600;cursor:pointer;text-align:center}.btn-submit.go{background:linear-gradient(135deg,var(--green),var(--teal));color:#fff}.btn-submit.appr{background:linear-gradient(135deg,var(--amber),#E5A00D);color:#fff}.btn-submit.disabled{background:var(--s2);color:var(--t4);cursor:not-allowed}
.agl{font-family:'IBM Plex Mono',monospace;font-size:7px;color:var(--t4);text-transform:uppercase;letter-spacing:1px;font-weight:600;margin:4px 0 3px;padding-top:4px;border-top:1px solid var(--brdL)}
.btn{width:100%;padding:6px 8px;border:none;border-radius:5px;font-family:'IBM Plex Mono',monospace;font-size:9px;font-weight:600;cursor:pointer;margin-bottom:2px;text-align:left;display:flex;align-items:center;gap:5px}.btn:hover{transform:translateY(-1px)}.btn-i{font-size:11px;width:14px;text-align:center}.btn-t{flex:1;font-size:9px}.btn-o{font-size:7px;padding:2px 5px;border-radius:3px;font-weight:600}
.b-sup{background:var(--orangeBg);color:var(--orange);border:1px solid var(--orangeBr)}.b-buy{background:var(--blueBg);color:var(--blue);border:1px solid var(--blueBr)}.b-gr{background:var(--amberBg);color:var(--amber);border:1px solid var(--amberBr)}.b-hold{background:var(--slateBg);color:var(--slate);border:1px solid var(--slateBr)}.b-esc{background:var(--purpleBg);color:var(--purple);border:1px solid var(--purpleBr)}.b-rej{background:var(--redBg);color:var(--red);border:1px solid var(--redBr)}
.rsel{width:100%;padding:4px 8px;border:1px solid var(--brd);border-radius:5px;font-size:9px;color:var(--t2);background:var(--surface);margin-bottom:3px;outline:none}
.ai-r{background:var(--surface);border:1px solid var(--brd);border-radius:6px;padding:6px 8px;margin-top:6px}.ai-rl{font-family:'IBM Plex Mono',monospace;font-size:7px;color:var(--purple);font-weight:700;margin-bottom:2px}.ai-rt{font-size:9px;color:var(--t3);line-height:1.5}
.bapi{margin-top:4px;font-family:'IBM Plex Mono',monospace;font-size:8px;color:var(--t4);line-height:1.5;padding:5px 6px;background:var(--s2);border-radius:4px}
.act-legend{margin-top:4px;display:flex;flex-wrap:wrap;gap:2px}.al-i{font-family:'IBM Plex Mono',monospace;font-size:6px;padding:2px 4px;border-radius:3px;font-weight:600}
/* MY WORK */
.mw-s{display:flex;align-items:center;padding:14px 24px;background:var(--surface);border-bottom:1px solid var(--brd)}.mw-g{display:flex;gap:24px}.mw-n{font-family:'IBM Plex Mono',monospace;font-size:20px;font-weight:700}.mw-l{font-size:8px;color:var(--t4);text-transform:uppercase;letter-spacing:1px;font-weight:600}
.mw-tabs{display:flex;gap:0;padding:0 24px;background:var(--surface);border-bottom:1px solid var(--brd)}.mw-tab{font-size:11px;padding:10px 16px;color:var(--t3);cursor:pointer;border-bottom:2px solid transparent;font-weight:500}.mw-tab.on{color:var(--t);border-bottom-color:var(--teal);font-weight:600}.nt{display:inline-flex;align-items:center;justify-content:center;min-width:16px;height:16px;border-radius:100px;font-size:8px;font-weight:700;margin-left:4px;padding:0 4px;font-family:'IBM Plex Mono',monospace}
.mw-c{padding:14px 24px;background:var(--surface);min-height:60vh}.mw-p{display:none;animation:fi .2s}.mw-p.on{display:block}
.fr{display:grid;grid-template-columns:10px 60px 1fr 100px 200px 100px;gap:10px;align-items:center;padding:10px 0;border-bottom:1px solid var(--brdL);font-size:11px}
.sd{width:9px;height:9px;border-radius:50%}.sd.hold{background:var(--slate);box-shadow:0 0 0 3px var(--slateBg)}.sd.sup{background:var(--orange);box-shadow:0 0 0 3px var(--orangeBg)}.sd.buy{background:var(--blue);box-shadow:0 0 0 3px var(--blueBg)}.sd.gr{background:var(--amber);box-shadow:0 0 0 3px var(--amberBg)}.sd.esc{background:var(--purple);box-shadow:0 0 0 3px var(--purpleBg)}.sd.ok{background:var(--green);box-shadow:0 0 0 3px var(--greenBg);animation:gl 2s ease infinite}@keyframes gl{0%,100%{box-shadow:0 0 0 3px var(--greenBg)}50%{box-shadow:0 0 0 6px rgba(5,150,105,.15)}}
.fo{font-family:'IBM Plex Mono',monospace;font-size:7px;font-weight:600;padding:3px 6px;border-radius:4px;text-align:center}.fo.hold{background:var(--slateBg);color:var(--slate)}.fo.sup{background:var(--orangeBg);color:var(--orange)}.fo.buy{background:var(--blueBg);color:var(--blue)}.fo.gr{background:var(--amberBg);color:var(--amber)}.fo.esc{background:var(--purpleBg);color:var(--purple)}.fo.ok{background:var(--greenBg);color:var(--green)}.fo.appr{background:var(--amberBg);color:var(--amber)}
.fv{font-size:12px;font-weight:600}.fsub{font-size:9px;color:var(--t4);margin-top:1px}.fa{font-family:'IBM Plex Mono',monospace;font-size:12px;font-weight:700;text-align:right}.fst{font-size:9px}.fac{font-family:'IBM Plex Mono',monospace;font-size:8px;padding:5px 10px;border-radius:5px;border:1px solid var(--brd);color:var(--t4);text-align:center;font-weight:600}.fac.rdy{background:var(--greenBg);border-color:var(--greenBr);color:var(--green);cursor:pointer}
.an{margin:6px 0 12px;padding:8px 14px;background:var(--greenBg);border-left:3px solid var(--green);border-radius:0 6px 6px 0;font-size:10px;color:var(--t2);display:flex;align-items:flex-start;gap:6px}.nn{font-family:'IBM Plex Mono',monospace;font-size:7px;font-weight:700;background:var(--green);color:#fff;padding:1px 5px;border-radius:3px;flex-shrink:0;margin-top:2px}
.pr{display:grid;grid-template-columns:1fr 100px 120px 140px;gap:12px;align-items:center;padding:8px 0;border-bottom:1px solid var(--brdL);font-size:11px}.prv{font-weight:600}.pri{font-size:8px;color:var(--t4)}.pra{font-family:'IBM Plex Mono',monospace;font-weight:700;text-align:right}.prd{font-family:'IBM Plex Mono',monospace;font-size:9px;color:var(--t3)}.prt{font-size:9px;color:var(--t4)}.prtot{display:flex;justify-content:space-between;padding:10px 0;border-top:1px solid var(--brd);margin-top:4px;font-weight:700}
.th{background:var(--s2);border:1px solid var(--brd);border-radius:10px;margin-bottom:10px;overflow:hidden}.th-h{display:flex;justify-content:space-between;align-items:center;padding:10px 14px;border-bottom:1px solid var(--brdL);cursor:pointer}.th-v{font-size:12px;font-weight:700}.th-i{font-size:8px;color:var(--t4)}.th-s{font-size:8px;padding:3px 8px;border-radius:100px;font-weight:600}.th-s.pen{background:var(--amberBg);color:var(--amber);border:1px solid var(--amberBr)}.th-b{padding:10px 14px;display:none}.th-b.open{display:block;animation:fi .2s}
.tm{display:flex;gap:8px;margin-bottom:8px}.ma{width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:7px;font-weight:700;flex-shrink:0;margin-top:2px}.ma.cl{background:linear-gradient(135deg,var(--teal),var(--blue));color:#fff}.mn{font-size:9px;font-weight:700}.mt{font-size:8px;color:var(--t4);margin-left:4px}.mx{font-size:10px;color:var(--t2);line-height:1.5;margin-top:2px}
.toast{position:fixed;bottom:20px;right:20px;background:var(--t);color:#fff;padding:12px 20px;border-radius:8px;font-size:11px;font-weight:500;box-shadow:0 8px 24px rgba(0,0,0,.15);transform:translateY(100px);opacity:0;transition:.3s;z-index:200}.toast.show{transform:none;opacity:1}
</style>
</head>
<body>
<nav class="nav"><div class="nav-l"><div class="logo">MANTRIX <span>AP</span></div><div class="tabs"><div class="tab on" onclick="go('inbox')">Inbox <span class="badge" style="background:var(--s2);color:var(--t3)">61</span></div><div class="tab" onclick="go('wb')">Workbench</div><div class="tab" onclick="go('mw')">My Work <span class="badge" style="background:var(--amberBg);color:var(--amber)">11</span></div></div></div><div class="nav-r"><a class="sap-link">‚óâ SAP Monitor</a><div class="org">Thales DSI ¬∑ Sarah Chen</div><div class="av">SC</div></div></nav>

<div id="V-inbox" class="v on">
<div class="kpi-bar"><div class="kpi-g"><div class="kpi"><div class="kpi-n">61</div><div class="kpi-l">Total Today</div></div><div class="kpi"><div class="kpi-n" style="color:var(--green)">46</div><div class="kpi-l">Ready</div></div><div class="kpi"><div class="kpi-n" style="color:var(--amber)">9</div><div class="kpi-l">Review</div></div><div class="kpi"><div class="kpi-n" style="color:var(--red)">4</div><div class="kpi-l">Exception</div></div><div class="kpi"><div class="kpi-n" style="color:var(--t4)">2</div><div class="kpi-l">Processing</div></div></div></div>

<!-- ‚ïê‚ïê‚ïê CHANNEL STRIP ‚Äî ALL INGESTION CHANNELS ‚ïê‚ïê‚ïê -->
<div class="ch-strip">
<div class="ch-card on" onclick="chF('all',this)"><div class="ch-top"><span class="ch-icon">üìä</span><span class="ch-tag all">ALL CHANNELS</span></div><div class="ch-count" style="color:var(--teal)">61</div><div class="ch-label">Total Invoices</div><div class="ch-val">$2.85M total value</div><div class="ch-bar"><div class="ch-seg" style="width:56%;background:var(--blue)"></div><div class="ch-seg" style="width:29%;background:var(--green)"></div><div class="ch-seg" style="width:15%;background:var(--purple)"></div></div><div class="ch-stats"><span class="ch-s-ok">üü¢ 46</span><span class="ch-s-w">üü° 9</span><span class="ch-s-e">üî¥ 4</span></div></div>
<div class="ch-card" onclick="chF('email',this)"><div class="ch-top"><span class="ch-icon">üìß</span><span class="ch-tag email">EMAIL / OCR</span></div><div class="ch-count" style="color:var(--blue)">34</div><div class="ch-label">PDF ‚Üí AI Extract</div><div class="ch-val">$1.68M ¬∑ 56%</div><div class="ch-bar"><div class="ch-seg" style="width:75%;background:var(--green)"></div><div class="ch-seg" style="width:18%;background:var(--amber)"></div><div class="ch-seg" style="width:7%;background:var(--red)"></div></div><div class="ch-stats"><span class="ch-s-ok">26</span><span class="ch-s-w">5</span><span class="ch-s-e">3</span></div><div class="ch-desc">Scanned PDF ¬∑ email attach ¬∑ AP mailbox</div></div>
<div class="ch-card" onclick="chF('edi',this)"><div class="ch-top"><span class="ch-icon">‚ö°</span><span class="ch-tag edi">EDI / IDOC</span></div><div class="ch-count" style="color:var(--green)">18</div><div class="ch-label">Machine-to-Machine</div><div class="ch-val">$892K ¬∑ 29%</div><div class="ch-bar"><div class="ch-seg" style="width:89%;background:var(--green)"></div><div class="ch-seg" style="width:6%;background:var(--amber)"></div><div class="ch-seg" style="width:5%;background:var(--red)"></div></div><div class="ch-stats"><span class="ch-s-ok">16</span><span class="ch-s-w">1</span><span class="ch-s-e">1</span></div><div class="ch-desc">EDI 810 ¬∑ IDOC INVOIC02 ¬∑ direct feed</div></div>
<div class="ch-card" onclick="chF('portal',this)"><div class="ch-top"><span class="ch-icon">üåê</span><span class="ch-tag portal">SUPPLIER PORTAL</span></div><div class="ch-count" style="color:var(--purple)">9</div><div class="ch-label">Web Submission</div><div class="ch-val">$286K ¬∑ 15%</div><div class="ch-bar"><div class="ch-seg" style="width:44%;background:var(--green)"></div><div class="ch-seg" style="width:33%;background:var(--amber)"></div><div class="ch-seg" style="width:23%;background:var(--red)"></div></div><div class="ch-stats"><span class="ch-s-ok">4</span><span class="ch-s-w">3</span><span class="ch-s-e">2</span></div><div class="ch-desc">Ariba ¬∑ Coupa ¬∑ self-service</div></div>
</div>

<div class="fbar"><div class="fg"><div class="fc on" onclick="tF('all',this)">All 61</div><div class="fc" onclick="tF('po',this)">PO 42</div><div class="fc" onclick="tF('nonpo',this)">Non-PO 19</div><div class="fc" onclick="tF('g',this)">üü¢</div><div class="fc" onclick="tF('a',this)">üü°</div><div class="fc" onclick="tF('r',this)">üî¥</div></div><input class="sbox" placeholder="Search vendor, PO, invoice..." oninput="sI(this.value)"></div>
<div class="slbl" id="S-po">PO-Based Invoices</div>
<div class="it" id="T-po">
<div class="ir" data-tp="po" data-cf="g" data-ch="edi" onclick="oW('safran')"><div class="cd g"></div><div class="lb">6</div><div><div class="iv">Safran Electronics & Defense</div><div class="im">INV-2026-4501 ¬∑ PO 4500087200 <span class="ch-b edi">‚ö° EDI</span></div></div><div class="ia">$128,400</div><div class="itp po">PO</div><div class="is" style="color:var(--green)">96</div><div class="ii"><strong>6/6</strong> exact ¬∑ <span class="tg ok">Auto-post</span></div></div>
<div class="ir" data-tp="po" data-cf="a" data-ch="email" onclick="oW('bae')"><div class="cd a"></div><div class="lb many">44</div><div><div class="iv">BAE Systems Electronic Systems</div><div class="im">INV-2026-4504 ¬∑ PO 4500087190 <span class="ch-b email">üìß EMAIL</span></div></div><div class="ia">$573,300</div><div class="itp po">PO+GL</div><div class="is" style="color:var(--amber)">82</div><div class="ii"><strong>38 PO ok</strong> ¬∑ <span class="tg w">4 price</span> ¬∑ <span class="tg d">2 GL lines</span></div></div>
<div class="ir" data-tp="po" data-cf="a" data-ch="email" onclick="oW('l3harris')"><div class="cd a"></div><div class="lb">9</div><div><div class="iv">L3Harris Technologies</div><div class="im">INV-2026-4505 ¬∑ PO 4500087205 <span class="ch-b email">üìß EMAIL</span></div></div><div class="ia">$91,800</div><div class="itp po">PO+GL</div><div class="is" style="color:var(--amber)">78</div><div class="ii"><strong>6 PO ok</strong> ¬∑ <span class="tg w">2 GR</span> ¬∑ <span class="tg d">1 GL freight</span></div></div>
<div class="ir" data-tp="po" data-cf="g" data-ch="portal" onclick="oW('te')"><div class="cd g"></div><div class="lb">3</div><div><div class="iv">TE Connectivity Aerospace</div><div class="im">INV-2026-4502 ¬∑ PO 4500087215 <span class="ch-b portal">üåê PORTAL</span></div></div><div class="ia">$18,200</div><div class="itp po">PO</div><div class="is" style="color:var(--green)">98</div><div class="ii"><strong>3/3</strong> exact</div></div>
<div class="ir" data-tp="po" data-cf="r" data-ch="email" onclick="oW('raytheon_dup')"><div class="cd r"></div><div class="lb">6</div><div><div class="iv">Raytheon Intelligence & Space</div><div class="im">INV-2026-4514 ¬∑ PO 4500087230 <span class="ch-b email">üìß EMAIL</span></div></div><div class="ia">$194,800</div><div class="itp po">PO</div><div class="is" style="color:var(--red)">22</div><div class="ii"><span class="tg d">‚ö† DUPLICATE</span></div></div>
<div class="ir" data-tp="po" data-cf="r" data-ch="portal" onclick="oW('elbit')"><div class="cd r"></div><div class="lb">4</div><div><div class="iv">Elbit Systems of America</div><div class="im">INV-2026-4515 ¬∑ PO 4500087240 <span class="ch-b portal">üåê PORTAL</span></div></div><div class="ia">$86,400</div><div class="itp po">PO</div><div class="is" style="color:var(--red)">31</div><div class="ii"><span class="tg o">Wrong entity</span></div></div>
<div class="ir proc" data-tp="po" data-cf="p" data-ch="edi"><div class="cd p"></div><div class="lb" style="color:var(--t4)">‚Äî</div><div><div class="iv" style="color:var(--t3)">Collins Aerospace</div><div class="im">Arrived 8:01 AM <span class="ch-b edi">‚ö° EDI</span></div></div><div class="ia" style="color:var(--t4)">‚Äî</div><div class="itp" style="background:var(--s2);color:var(--t4)">‚Äî</div><div class="is" style="color:var(--t4)">‚Äî</div><div><div class="pb"><div class="ps">Matching...</div><div class="pt"><div class="pf" style="width:65%"></div></div></div></div></div>
</div>
<div class="slbl" id="S-np">Non-PO Invoices</div>
<div class="it" id="T-np">
<div class="ir" data-tp="nonpo" data-cf="g" data-ch="email" onclick="oW('cintas')"><div class="cd g"></div><div class="lb">1</div><div><div class="iv">Cintas Corporation</div><div class="im">INV-2026-4509 ¬∑ Non-PO <span class="ch-b email">üìß EMAIL</span></div></div><div class="ia">$1,850</div><div class="itp np">Non-PO</div><div class="is" style="color:var(--green)">95</div><div class="ii"><strong>AI coded</strong> GL 62100 ¬∑ <span class="tg ok">Auto-post</span></div></div>
<div class="ir" data-tp="nonpo" data-cf="a" data-ch="email" onclick="oW('grainger')"><div class="cd a"></div><div class="lb">12</div><div><div class="iv">W.W. Grainger Inc.</div><div class="im">INV-2026-4508 ¬∑ Non-PO <span class="ch-b email">üìß EMAIL</span></div></div><div class="ia">$3,240</div><div class="itp np">Non-PO</div><div class="is" style="color:var(--amber)">85</div><div class="ii"><strong>10/12</strong> ¬∑ <span class="tg w">2 GL review</span></div></div>
<div class="ir" data-tp="nonpo" data-cf="a" data-ch="portal" onclick="oW('kaman')"><div class="cd a"></div><div class="lb">3</div><div><div class="iv">Kaman Aerospace Services</div><div class="im">INV-2026-4513 ¬∑ Non-PO <span class="ch-b portal">üåê PORTAL</span></div></div><div class="ia">$22,400</div><div class="itp np">Non-PO</div><div class="is" style="color:var(--amber)">80</div><div class="ii"><strong>2/3</strong> ¬∑ <span class="tg w">expense vs capital?</span></div></div>
</div>
</div>

<div id="V-wb" class="v"><div class="wb-top"><div class="wb-bk" onclick="go('inbox')">‚Üê Back to Inbox</div><div style="flex:1"></div><div style="text-align:right"><div class="wb-v" id="WV"></div><div class="wb-m" id="WM"></div></div><div class="wb-a" id="WA" style="margin-left:20px"></div></div><div class="wb-p"><div class="wp wp-l" id="WL"></div><div class="wp wp-c" id="WC"></div><div class="wp wp-r" id="WR"></div></div></div>

<div id="V-mw" class="v">
<div class="mw-s"><div class="mw-g"><div><div class="mw-n" style="color:var(--amber)">11</div><div class="mw-l">In Flight</div></div><div><div class="mw-n" style="color:var(--green)">5</div><div class="mw-l">Posted Today</div></div><div><div class="mw-n">$536,650</div><div class="mw-l">Value Posted</div></div></div></div>
<div class="mw-tabs"><div class="mw-tab on" onclick="mwT('flight')">In Flight <span class="nt" style="background:var(--amberBg);color:var(--amber)">7</span></div><div class="mw-tab" onclick="mwT('posted')">Posted <span class="nt" style="background:var(--greenBg);color:var(--green)">5</span></div><div class="mw-tab" onclick="mwT('threads')">Threads <span class="nt" style="background:var(--blueBg);color:var(--blue)">2</span></div></div>
<div class="mw-c">
<div class="mw-p on" id="P-flight">
<div class="an"><div class="nn">NEW</div><div><strong>GR Posted:</strong> Honeywell ‚Äî 3 lines ready $94,200</div></div>
<div class="fr"><div class="sd ok"></div><div class="fo ok">‚Üí READY</div><div><div class="fv">Honeywell Aerospace</div><div class="fsub">GR posted 7:58 AM</div></div><div class="fa" style="color:var(--green)">$94,200</div><div class="fst" style="color:var(--green)">All matched</div><div class="fac rdy" onclick="pfm(this,'‚Üí Doc 5105002346')">‚Üí Post</div></div>
<div class="fr"><div class="sd hold"></div><div class="fo hold">HOLD</div><div><div class="fv">Leonardo DRS</div><div class="fsub">AI monitoring GR</div></div><div class="fa" style="color:var(--slate)">$87,400</div><div class="fst" style="color:var(--slate)">EKET 2d overdue</div><div class="fac">Waiting</div></div>
<div class="fr"><div class="sd sup"></div><div class="fo sup">‚Üí SUPPLIER</div><div><div class="fv">Elbit Systems</div><div class="fsub">Wrong entity</div></div><div class="fa" style="color:var(--orange)">$86,400</div><div class="fst" style="color:var(--orange)">Returned</div><div class="fac">Sent</div></div>
<div class="fr"><div class="sd buy"></div><div class="fo buy">‚Üí BUYER</div><div><div class="fv">BAE Systems</div><div class="fsub">4 lines ‚Üí Dupont</div></div><div class="fa">$52,200</div><div class="fst" style="color:var(--blue)">Routed</div><div class="fac">Pending</div></div>
<div class="fr"><div class="sd gr"></div><div class="fo gr">‚Üí GR/OPS</div><div><div class="fv">L3Harris</div><div class="fsub">Warehouse Bordeaux</div></div><div class="fa" style="color:var(--amber)">$18,600</div><div class="fst" style="color:var(--amber)">Pending GR</div><div class="fac">Pending</div></div>
<div class="fr"><div class="sd esc"></div><div class="fo esc">‚Üë AP LEAD</div><div><div class="fv">Safran (threshold)</div><div class="fsub">$210K ‚Üí M. Laurent</div></div><div class="fa">$210,000</div><div class="fst" style="color:var(--purple)">Escalated</div><div class="fac">Pending</div></div>
<div class="fr"><div class="sd" style="background:var(--amber);box-shadow:0 0 0 3px var(--amberBg)"></div><div class="fo appr">‚è≥ APPROVAL</div><div><div class="fv">Grainger Inc.</div><div class="fsub">New GL codes</div></div><div class="fa">$3,240</div><div class="fst" style="color:var(--amber)">P. Moreau</div><div class="fac">Awaiting</div></div>
</div>
<div class="mw-p" id="P-posted">
<div class="pr"><div><div class="prv">Safran Electronics</div><div class="pri">6 lines ¬∑ ‚ö° EDI</div></div><div class="pra">$128,400</div><div class="prd">Doc 5105002341</div><div class="prt">8:15 AM ¬∑ Auto</div></div>
<div class="pr"><div><div class="prv">TE Connectivity</div><div class="pri">3 lines ¬∑ üåê Portal</div></div><div class="pra">$18,200</div><div class="prd">Doc 5105002342</div><div class="prt">8:18 AM ¬∑ Auto</div></div>
<div class="pr"><div><div class="prv">Mercury Systems</div><div class="pri">24 lines ¬∑ üìß Email</div></div><div class="pra">$342,600</div><div class="prd">Doc 5105002344</div><div class="prt">8:35 AM</div></div>
<div class="pr"><div><div class="prv">Cintas Corp</div><div class="pri">1 line ¬∑ üìß Email</div></div><div class="pra">$1,850</div><div class="prd">Doc 5105002345</div><div class="prt">8:40 AM ¬∑ Auto</div></div>
<div class="pr"><div><div class="prv">Curtiss-Wright</div><div class="pri">5 lines ¬∑ ‚ö° EDI</div></div><div class="pra">$45,600</div><div class="prd">Doc 5105002343</div><div class="prt">8:22 AM</div></div>
<div class="prtot"><span style="color:var(--t3)">5 posted</span><span style="color:var(--green)">$536,650</span></div>
</div>
<div class="mw-p" id="P-threads">
<div class="th"><div class="th-h" onclick="tTh(this)"><div><div class="th-v">Elbit Systems</div><div class="th-i">Wrong entity</div></div><div class="th-s pen">Awaiting</div></div><div class="th-b"><div class="tm"><div class="ma cl">SC</div><div><div class="mn">Sarah Chen <span class="mt">7:45 AM</span></div><div class="mx">Please reissue to Thales DSI Inc., 22 Campus Dr, Parsippany NJ 07054.</div></div></div></div></div>
<div class="th"><div class="th-h" onclick="tTh(this)"><div><div class="th-v">L3Harris</div><div class="th-i">Qty 24‚Üí18</div></div><div class="th-s pen">Pending</div></div><div class="th-b"><div class="tm"><div class="ma cl">SC</div><div><div class="mn">Sarah Chen <span class="mt">Feb 6</span></div><div class="mx">GR shows 18 EA. Confirm 6 shipped or revise.</div></div></div></div></div>
</div></div></div>

<div class="toast" id="toast"><span id="tmsg"></span></div>
<script>
/*
LINE FORMAT: [desc,col2,col3,col4,qty,uom,price,amt,tax,col10,matchLabel,status,bol,delNote,lineType]
lineType: 'po' = PO-matched line, 'gl' = GL-coded line (even on PO invoice)
For PO lines: col2=PO#, col3=POItem, col4=Material, col10=GR
For GL lines: col2=GLAcct, col3=CostCenter, col4=ProfitCenter, col10=confidence
*/
const D={
safran:{v:'Safran Electronics & Defense',m:'INV-2026-4501 ¬∑ PO 4500087200 ¬∑ 6 lines ¬∑ ICS: 96',a:'$128,400.00',pdf:'INV-2026-4501.pdf',ch:'edi',isNonPO:false,editAll:true,
tl:[1,1,2,0,1,0],tlLabels:['Ingested','Extracted','Draft','Approval','Ready','Posted'],
appr:{needed:false,reason:'PO match ¬∑ trust 98.2%'},
ev:[['Vendor #','0000198450','h'],['Vendor','Safran Electronics','h'],['Currency','USD','h'],['Tax','V1 ‚Äî 8.25%','h'],['Company','1000 ‚Äî Thales DSI','h'],['Channel','‚ö° EDI 810 ‚Äî structured','h']],
hdr:[{l:'PO Number',v:'4500087200',ed:true},{l:'Invoice Date',v:'02/03/2026',ed:true},{l:'Invoice #',v:'INV-2026-4501',ed:true},{l:'Amount',v:'128,400.00',ed:true},{l:'Terms',v:'NET 30',ed:true},{l:'Vendor #',v:'0000198450',ed:false}],
vd:[{c:'ok',t:'‚úî 6/6 exact ¬∑ GR Jan 28'},{c:'ok',t:'‚úî Trust 98.2% ¬∑ no GL lines'}],
lines:[
['Inertial Nav Unit INU-4000','4500087200','10','INU-4000','2','EA','34,200.00','68,400.00','V1','5000441200','Match','ok','BOL-88401','DN-2026-0180','po'],
['Ring Laser Gyro RLG-580','4500087200','20','RLG-580','4','EA','12,600.00','50,400.00','V1','5000441200','Match','ok','BOL-88401','DN-2026-0180','po'],
['Nav Computer NAV-900','4500087200','30','NAV-900','2','EA','18,400.00','36,800.00','V1','5000441200','Match','ok','BOL-88401','DN-2026-0180','po'],
['AHRS Sensor SU-200','4500087200','40','SU-200','6','EA','4,200.00','25,200.00','V1','5000441201','Match','ok','BOL-88402','DN-2026-0181','po'],
['GPS Antenna GA-100','4500087200','50','GA-100','8','EA','1,800.00','14,400.00','V1','5000441201','Match','ok','BOL-88402','DN-2026-0181','po'],
['Integ Test Kit ITK-50','4500087200','60','ITK-50','2','EA','2,100.00','4,200.00','V1','5000441201','Match','ok','BOL-88402','DN-2026-0181','po']],
rc:null,submit:{label:'Submit to SAP',cls:'go'},acts:[],rsn:null,ai:'All 6 exact. 2 shipments (BOL-88401/02). Auto-post.',bapi:'BAPI_INCOMINGINVOICE_CREATE\n6 PO items ¬∑ $128,400 ¬∑ 2 GR refs'},

bae:{v:'BAE Systems Electronic Systems',m:'INV-2026-4504 ¬∑ PO 4500087190 ¬∑ 44 lines (42 PO + 2 GL) ¬∑ ICS: 82',a:'$573,300.00',pdf:'INV-2026-4504.pdf',ch:'email',isNonPO:false,editAll:true,
tl:[1,1,2,0,0,0],tlLabels:['Ingested','Extracted','Draft','Approval','Ready','Posted'],
appr:{needed:true,reason:'Price variance >5% on 4 PO lines + 2 unplanned GL lines.',who:'J.M. Dupont (Buyer) + P. Moreau (CC Owner)'},
ev:[['Vendor #','0000201340','h'],['Currency','USD','h'],['Company','1000','h'],['Channel','üìß Email ‚Äî OCR extracted','h']],
hdr:[{l:'PO Number',v:'4500087190',ed:true},{l:'Invoice Date',v:'02/01/2026',ed:true},{l:'Invoice #',v:'INV-2026-4504',ed:true},{l:'Amount',v:'573,300.00',ed:true},{l:'Terms',v:'NET 60',ed:true},{l:'Vendor #',v:'0000201340',ed:false}],
vd:[{c:'ok',t:'‚úî 38 PO lines exact'},{c:'w',t:'‚ö† 4 PO lines ‚Äî price +6.2%'},{c:'d',t:'üü£ 2 GL lines ‚Äî freight + handling, need CC assignment'}],
lines:[
['Threat Warning TWC-200','4500087190','10','TWC-200','3','EA','42,000.00','126,000.00','V1','5000441210','Match','ok','BOL-91200','DN-2026-0195','po'],
['Countermeasure CMD-400','4500087190','20','CMD-400','6','EA','18,400.00','110,400.00','V1','5000441210','Match','ok','BOL-91200','DN-2026-0195','po'],
['IR Jammer IJM-300','4500087190','30','IJM-300','4','EA','28,600.00','114,400.00','V1','5000441210','Match','ok','BOL-91201','DN-2026-0196','po'],
['RF Exciter RFX-100','4500087190','35','RFX-100','2','EA','13,170.00','26,340.00','V1','5000441211','+6.2%','w','BOL-91201','DN-2026-0196','po'],
['Power Amp PAM-60','4500087190','38','PAM-60','3','EA','8,600.00','25,800.00','V1','5000441211','+6.2%','w','BOL-91201','DN-2026-0196','po'],
['Freight ‚Äî Hazmat Air Shipment','65000','4200','PC-1100','1','LOT','3,860.00','3,860.00','V0','AI 88%','AI Coded','ok','‚Äî','‚Äî','gl'],
['Handling ‚Äî Export Crating','65200','4200','PC-1100','1','LOT','1,640.00','1,640.00','V0','AI 82%','AI 82%','w','‚Äî','‚Äî','gl']],
rc:{p:'BAE 22% variance on EW parts.',b:'PO rev 03 not yet in EKPO. Freight/handling not on PO ‚Äî standard for BAE hazmat.',pr:'PO amend 48h. GL lines need CC owner sign-off.',r:'Post 38 PO clean. Route 4 ‚Üí buyer. GL lines ‚Üí approval.'},
submit:{label:'Submit 38 PO + 1 GL for Approval',cls:'appr'},acts:[{l:'‚Üí Route 4 Price ‚Üí Buyer Dupont',c:'b-buy',i:'‚Üí',o:'‚Üí Buyer',oc:'blueBg'}],rsn:null,ai:'38 PO clean + 1 GL freight ok. 4 price variance ‚Üí buyer. 1 GL handling at 82% ‚Üí CC approval.',bapi:'Post 38 PO ‚Üí BAPI ($515,600)\n1 GL freight ‚Üí BAPI ($3,860)\nRoute 4 PO ‚Üí WF ($52,200)\n1 GL handling ‚Üí Approval'},

l3harris:{v:'L3Harris Technologies',m:'INV-2026-4505 ¬∑ PO 4500087205 ¬∑ 9 lines (8 PO + 1 GL) ¬∑ ICS: 78',a:'$91,800.00',pdf:'INV-2026-4505.pdf',ch:'email',isNonPO:false,editAll:true,
tl:[1,1,2,0,0,0],tlLabels:['Ingested','Extracted','Draft','Approval','Ready','Posted'],
appr:{needed:false,reason:'6 PO matched. 2 GR pending. 1 GL freight AI-coded 94%.'},
ev:[['Vendor #','0000199870','h'],['Currency','USD','h'],['Channel','üìß Email ‚Äî OCR','h']],
hdr:[{l:'PO',v:'4500087205',ed:true},{l:'Date',v:'02/02/2026',ed:true},{l:'Inv #',v:'INV-2026-4505',ed:true},{l:'Amount',v:'91,800.00',ed:true},{l:'Terms',v:'NET 45',ed:true},{l:'Vendor #',v:'0000199870',ed:false}],
vd:[{c:'ok',t:'‚úî 6 PO lines exact'},{c:'w',t:'‚ö† 2 PO ‚Äî Qty 24 vs GR 18'},{c:'d',t:'üü£ 1 GL ‚Äî freight charge $2,500, AI coded 94%'}],
lines:[
['SATCOM Terminal STX-2000','4500087205','10','STX-2000','2','EA','14,200.00','28,400.00','V1','5000441280','Match','ok','BOL-93100','DN-2026-0210','po'],
['Encryption Module CYZ-110','4500087205','20','CYZ-110','10','EA','3,400.00','34,000.00','V1','5000441280','Match','ok','BOL-93100','DN-2026-0210','po'],
['Tactical Radio AN/PRC-163','4500087205','40','AN/PRC-163','24','EA','4,200.00','100,800.00','V1','‚Äî','GR:18','w','BOL-93101','DN-2026-0211','po'],
['Radio Battery RBP-20','4500087205','42','RBP-20','24','EA','1,050.00','25,200.00','V1','‚Äî','GR:18','w','BOL-93101','DN-2026-0211','po'],
['Freight ‚Äî Ground LTL Bordeaux','65000','4300','PC-1200','1','LOT','2,500.00','2,500.00','V0','AI 94%','AI 94%','ok','‚Äî','‚Äî','gl']],
rc:{p:'L3Harris partial-shipped 4√ó.',b:'Warehouse Bordeaux. Freight charge standard ‚Äî $2,500 LTL recurring.',pr:'GR for remaining 6 expected Feb 12.',r:'Post 6 PO + 1 GL freight. Route 2 ‚Üí GR/Ops.'},
submit:{label:'Submit 6 PO + 1 GL to SAP',cls:'go'},acts:[{l:'üè≠ Send 2 ‚Üí GR/Ops Bordeaux',c:'b-gr',i:'üè≠',o:'‚Üí Warehouse',oc:'amberBg'},{l:'‚è∏ Hold ‚Äî AI Watch GR',c:'b-hold',i:'‚è∏',o:'‚Üí Time',oc:'slateBg'}],rsn:null,ai:'Post 6 PO ($62,400) + 1 GL freight ($2,500). Route 2 qty mismatch ‚Äî separate BOL-93101.',bapi:'Post 6 PO ‚Üí BAPI ($62,400)\n1 GL freight ‚Üí BAPI ($2,500)\nRoute 2 ‚Üí GR/Ops ($126,000)'},

te:{v:'TE Connectivity Aerospace',m:'INV-2026-4502 ¬∑ PO 4500087215 ¬∑ 3 lines ¬∑ ICS: 98',a:'$18,200.00',pdf:'INV-2026-4502.pdf',ch:'portal',isNonPO:false,editAll:true,tl:[1,1,2,0,1,0],tlLabels:['Ingested','Extracted','Draft','Approval','Ready','Posted'],appr:{needed:false,reason:'Exact ¬∑ trust 99.1%'},ev:[['Vendor #','0000187600','h'],['Currency','USD','h'],['Channel','üåê Ariba ‚Äî structured XML','h']],hdr:[{l:'PO',v:'4500087215',ed:true},{l:'Date',v:'02/04/2026',ed:true},{l:'Inv #',v:'INV-2026-4502',ed:true},{l:'Amount',v:'18,200.00',ed:true},{l:'Terms',v:'NET 30',ed:true}],vd:[{c:'ok',t:'‚úî 3/3 exact ¬∑ 99.1%'}],
lines:[['MIL-DTL-38999 Connector','4500087215','10','38999-III','200','EA','42.00','8,400.00','V1','5000441250','Match','ok','BOL-90100','DN-2026-0170','po'],['Shielded Cable SCA-400','4500087215','20','SCA-400','50','EA','124.00','6,200.00','V1','5000441250','Match','ok','BOL-90100','DN-2026-0170','po'],['Backshell BS-22','4500087215','30','BS-22','200','EA','18.00','3,600.00','V1','5000441250','Match','ok','BOL-90100','DN-2026-0170','po']],
rc:null,submit:{label:'Submit to SAP',cls:'go'},acts:[],rsn:null,ai:'Perfect match. Auto-post.',bapi:'BAPI (3 PO items ¬∑ $18,200)'},

raytheon_dup:{v:'Raytheon Intelligence & Space',m:'INV-2026-4514 ¬∑ DUPLICATE ¬∑ ICS: 22',a:'$194,800.00',pdf:'INV-2026-4514.pdf',ch:'email',isNonPO:false,editAll:false,tl:[1,1,2,0,0,0],tlLabels:['Ingested','Extracted','Draft','‚Äî','‚Äî','‚Äî'],appr:{needed:false,reason:'Duplicate ‚Äî rejection.'},ev:[['Vendor #','0000200100','h'],['DUPLICATE OF','Doc 5105002320','l'],['Channel','üìß Email ‚Äî OCR','h']],hdr:[{l:'PO',v:'4500087230',ed:false},{l:'Amount',v:'194,800.00',ed:false},{l:'Original',v:'Doc 5105002320',ed:false}],vd:[{c:'d',t:'‚ö† DUPLICATE ‚Äî Feb 3'},{c:'e',t:'‚úó BKPF exists'}],
lines:[['Radar RPU-3000','4500087230','10','RPU-3000','2','EA','48,400.00','96,800.00','V1','DUP','DUPLICATE','m','BOL-94500','DN-2026-0220','po'],['Signal Intel SIM-200','4500087230','20','SIM-200','4','EA','24,500.00','98,000.00','V1','DUP','DUPLICATE','m','BOL-94500','DN-2026-0220','po']],
rc:null,submit:{label:'‚Äî Cannot Post',cls:'disabled'},acts:[{l:'‚úó Reject Duplicate',c:'b-rej',i:'‚úó',o:'‚Üí Audit',oc:'redBg'},{l:'‚Üë Escalate',c:'b-esc',i:'‚Üë',o:'‚Üí AP Lead',oc:'purpleBg'}],rsn:['Duplicate','Vendor error','Other'],ai:'Confirmed duplicate. Reject.',bapi:'No BAPI ‚Äî ZINV_AUDIT'},

elbit:{v:'Elbit Systems of America',m:'INV-2026-4515 ¬∑ Wrong Entity ¬∑ ICS: 31',a:'$86,400.00',pdf:'INV-2026-4515.pdf',ch:'portal',isNonPO:false,editAll:false,tl:[1,1,2,0,0,0],tlLabels:['Ingested','Extracted','Draft','‚Äî','‚Äî','‚Äî'],appr:{needed:false,reason:'Return ‚Äî no approval.'},ev:[['Vendor #','0000208500','h'],['Bill To','Thales AVS (2000)','l'],['Should Be','Thales DSI (1000)','l'],['Channel','üåê Portal','h']],hdr:[{l:'PO',v:'4500087240',ed:false},{l:'Amount',v:'86,400.00',ed:false}],vd:[{c:'e',t:'‚úó Wrong entity'},{c:'ok',t:'‚úî Lines match if rebilled'}],
lines:[['Helmet Display HDU-100','4500087240','10','HDU-100','4','EA','12,600.00','50,400.00','V1','5000441300','Wrong Co','m','BOL-95200','DN-2026-0230','po'],['Day/Night Cam DNC-40','4500087240','20','DNC-40','2','EA','18,000.00','36,000.00','V1','5000441300','Wrong Co','m','BOL-95200','DN-2026-0230','po']],
rc:null,submit:{label:'‚Äî Cannot Post',cls:'disabled'},acts:[{l:'‚Üê Return to Supplier',c:'b-sup',i:'‚Üê',o:'‚Üí Supplier',oc:'orangeBg'}],rsn:['Wrong entity','Other'],ai:'Wrong entity. Reissue to DSI.',bapi:'No BAPI ‚Äî return'},

cintas:{v:'Cintas Corporation',m:'INV-2026-4509 ¬∑ Non-PO ¬∑ 1 line ¬∑ ICS: 95',a:'$1,850.00',pdf:'INV-2026-4509.pdf',ch:'email',isNonPO:true,editAll:true,tl:[1,1,2,0,1,0],tlLabels:['Ingested','Extracted','Draft','Approval','Ready','Posted'],appr:{needed:false,reason:'Recurring ¬∑ ¬±3%'},ev:[['Vendor #','0000142800','h'],['Vendor','Cintas','h'],['Channel','üìß Email ‚Äî OCR','h']],hdr:[{l:'Date',v:'02/01/2026',ed:true},{l:'Inv #',v:'INV-2026-4509',ed:true},{l:'Amount',v:'1,850.00',ed:true},{l:'Terms',v:'NET 30',ed:true}],vd:[{c:'ok',t:'‚úî Recurring ¬∑ AI coded 98%'}],
lines:[['Monthly Uniform Service Feb','62100','4200','PC-1100','1','LOT','1,850.00','1,850.00','V0','AI 98%','AI 98%','ok','‚Äî','‚Äî','gl']],
rc:null,submit:{label:'Submit to SAP',cls:'go'},acts:[],rsn:null,ai:'Monthly Cintas. GL 62100/CC 4200. Auto-post.',bapi:'BAPI (1 GL item ¬∑ $1,850)'},

grainger:{v:'W.W. Grainger Inc.',m:'INV-2026-4508 ¬∑ Non-PO ¬∑ 12 lines ¬∑ ICS: 85',a:'$3,240.00',pdf:'INV-2026-4508.pdf',ch:'email',isNonPO:true,editAll:true,tl:[1,1,2,1,0,0],tlLabels:['Ingested','Extracted','Draft','Approval','Ready','Posted'],appr:{needed:true,reason:'2 new GL codes 72%.',who:'P. Moreau (CC Owner)'},ev:[['Vendor #','0000156200','h'],['Vendor','Grainger','h'],['Channel','üìß Email ‚Äî OCR','h']],hdr:[{l:'Date',v:'02/05/2026',ed:true},{l:'Inv #',v:'INV-2026-4508',ed:true},{l:'Amount',v:'3,240.00',ed:true},{l:'Terms',v:'NET 30',ed:true}],vd:[{c:'ok',t:'‚úî 10/12 >90%'},{c:'w',t:'‚ö† 2 LED ‚Äî GL 65200 at 72%'}],
lines:[['Safety Gloves Nitrile','63100','4200','PC-1100','10','CS','48.00','480.00','V0','AI 95%','AI 95%','ok','‚Äî','‚Äî','gl'],['WD-40 Industrial','63100','4200','PC-1100','4','GAL','32.00','128.00','V0','AI 95%','AI 95%','ok','‚Äî','‚Äî','gl'],['LED Panel 4ft (NEW)','65200','4200','PC-1100','6','EA','42.00','252.00','V0','AI 72%','AI 72%','w','‚Äî','‚Äî','gl'],['LED Driver (NEW)','65200','4200','PC-1100','6','EA','38.00','228.00','V0','AI 72%','AI 72%','w','‚Äî','‚Äî','gl']],
rc:null,submit:{label:'Submit for Approval',cls:'appr'},acts:[],rsn:null,ai:'10 MRO ok. 2 LED 72%. Edit‚Üíapproval.',bapi:'BAPI (12 GL items ¬∑ $3,240)'}
};

function go(v){document.querySelectorAll('.v').forEach(e=>e.classList.remove('on'));document.querySelectorAll('.tab').forEach(e=>e.classList.remove('on'));document.getElementById('V-'+v).classList.add('on');let t=document.querySelectorAll('.tab');if(v==='inbox')t[0].classList.add('on');if(v==='wb')t[1].classList.add('on');if(v==='mw')t[2].classList.add('on')}

function oW(id){
let d=D[id];if(!d)return;
document.querySelectorAll('.ir').forEach(r=>r.classList.remove('sel'));
if(event&&event.currentTarget)event.currentTarget.classList.add('sel');
document.getElementById('WV').textContent=d.v;document.getElementById('WM').textContent=d.m;document.getElementById('WA').textContent=d.a;

/* Detect mixed invoice: has both PO and GL lines */
let hasPO=d.lines.some(l=>l[14]==='po'),hasGL=d.lines.some(l=>l[14]==='gl');
let isMixed=hasPO&&hasGL;

/* LEFT ‚Äî Channel badge + PDF + Evidence */
let chTag=d.ch==='edi'?'<span class="ch-b edi" style="font-size:9px;padding:4px 8px">‚ö° EDI / IDOC</span>':d.ch==='portal'?'<span class="ch-b portal" style="font-size:9px;padding:4px 8px">üåê SUPPLIER PORTAL</span>':'<span class="ch-b email" style="font-size:9px;padding:4px 8px">üìß EMAIL / OCR</span>';
let L='<div style="text-align:center;margin-bottom:8px">'+chTag+'</div><div class="pdf-c"><div style="font-size:28px;opacity:.3">üìÑ</div><div style="font-size:9px;color:var(--t4)">'+d.pdf+'</div></div>';
L+='<div style="font-family:\'IBM Plex Mono\',monospace;font-size:7px;color:var(--t4);text-transform:uppercase;letter-spacing:1px;font-weight:600;margin:8px 0 4px">Extracted Data</div>';
d.ev.forEach(e=>{let cls=e[2]==='h'?'ok':'e';L+='<div class="ev-row"><span class="ev-l">'+e[0]+'</span><span class="ev-v '+cls+'"><span class="ev-dot '+e[2]+'"></span>'+e[1]+'</span></div>'});
document.getElementById('WL').innerHTML=L;

/* CENTER ‚Äî Header + Verdicts + UNIFIED GRID (PO + GL lines mixed) */
let C='<div class="hdr-bar">';d.hdr.forEach(h=>{C+='<div class="hf-grp"><div class="hf-l">'+h.l+'</div><input class="hf-inp'+(h.ed?'':' lock')+'" value="'+h.v+'" '+(h.ed?'':'readonly')+'></div>'});C+='</div>';
C+='<div class="vrd-bar">'+d.vd.map(v=>'<div class="vrd '+v.c+'">'+v.t+'</div>').join('')+'</div>';

/* Grid toolbar label */
let gLabel='Invoice Lines';
if(isMixed)gLabel='Invoice Lines ‚Äî Mixed PO + GL ¬∑ BOL / Delivery at Line Level';
else if(hasPO)gLabel='Invoice Lines ‚Äî PO Match ¬∑ BOL / Delivery at Line Level';
else gLabel='Invoice Lines ‚Äî GL Coding';
C+='<div class="grid-toolbar"><div class="gt-l">'+gLabel+'</div><div class="gt-r"><div class="gt-btn" onclick="toast(\'+ PO Line added\')">+ PO Line</div><div class="gt-btn" onclick="toast(\'+ GL Line added\')">+ GL Line</div><div class="gt-btn" onclick="toast(\'Line removed\')" style="color:var(--red)">‚àí Remove</div></div></div>';

/* UNIFIED TABLE ‚Äî Type column determines what col2-4 show */
C+='<div class="grid-wrap"><table class="g-tbl"><thead><tr><th>#</th><th>Type</th><th>Description</th>';
C+='<th>PO# / GL Acct</th><th>PO Itm / Cost Ctr</th><th>Material / Profit Ctr</th>';
C+='<th class="r">Qty</th><th>UoM</th><th class="r">Price</th><th class="r">Amount</th><th>Tax</th>';
C+='<th>GR / Conf.</th><th>BOL #</th><th>Del. Note</th><th>Status</th></tr></thead><tbody>';

d.lines.forEach((l,i)=>{
let isGL=l[14]==='gl';
let rc=l[11]==='ok'?isGL?'row-ok row-gl':'row-ok':l[11]==='w'?isGL?'row-w row-gl':'row-w':'row-e';
let ed=d.editAll;
C+='<tr class="'+rc+'">';
C+='<td><span class="gc-ro" style="color:var(--t4)">'+(i+1)+'</span></td>';
/* Type badge */
C+='<td><span class="lt '+(isGL?'gl':'po')+'">'+(isGL?'GL':'PO')+'</span></td>';
C+='<td>'+(ed?'<input class="gc txt" value="'+l[0]+'">':'<span class="gc-ro">'+l[0]+'</span>')+'</td>';

if(isGL){
    /* GL line: col2=GL, col3=CC, col4=PC ‚Äî editable with split */
    C+='<td>'+(ed?'<input class="gc med" value="'+l[1]+'" placeholder="GL Acct">':'<span class="gc-ro" style="color:var(--purple)">'+l[1]+'</span>')+'</td>';
    C+='<td>'+(ed?'<input class="gc med" value="'+l[2]+'" placeholder="Cost Ctr"> <button class="split-btn" onclick="toast(\'Split: enter %\')">‚äï</button>':'<span class="gc-ro" style="color:var(--purple)">'+l[2]+'</span>')+'</td>';
    C+='<td>'+(ed?'<input class="gc med" value="'+l[3]+'" placeholder="Profit Ctr">':'<span class="gc-ro" style="color:var(--purple)">'+l[3]+'</span>')+'</td>';
}else{
    /* PO line: col2=PO#, col3=POItem, col4=Material */
    C+='<td>'+(ed?'<input class="gc med" value="'+l[1]+'">':'<span class="gc-ro">'+l[1]+'</span>')+'</td>';
    C+='<td><span class="gc-ro">'+l[2]+'</span></td>';
    C+='<td>'+(ed&&l[3]!=='‚Äî'?'<select class="gc-sel"><option>'+l[3]+'</option></select>':'<span class="gc-ro">'+l[3]+'</span>')+'</td>';
}
C+='<td>'+(ed?'<input class="gc sm" value="'+l[4]+'">':'<span class="gc-ro" style="text-align:right">'+l[4]+'</span>')+'</td>';
C+='<td>'+(ed?'<input class="gc" style="width:32px" value="'+l[5]+'">':'<span class="gc-ro">'+l[5]+'</span>')+'</td>';
C+='<td>'+(ed?'<input class="gc med" value="'+l[6]+'">':'<span class="gc-ro" style="text-align:right">'+l[6]+'</span>')+'</td>';
C+='<td>'+(ed?'<input class="gc lg" value="'+l[7]+'">':'<span class="gc-ro" style="text-align:right">'+l[7]+'</span>')+'</td>';
C+='<td>'+(ed?'<select class="gc-sel"><option>'+l[8]+'</option><option>V0</option><option>V1</option></select>':'<span class="gc-ro">'+l[8]+'</span>')+'</td>';
/* GR Ref (PO) or Confidence (GL) */
if(isGL){C+='<td><span class="mb '+(l[10].includes('9')?'ok':'v')+'">'+l[9]+'</span></td>'}
else{let gc=l[9]==='‚Äî'||l[9]==='DUP'?'var(--red)':'var(--green)';C+='<td><span class="gc-ro" style="color:'+gc+'">'+l[9]+'</span></td>'}
/* BOL + Delivery Note ‚Äî line level */
C+='<td>'+(ed&&l[12]!=='‚Äî'?'<input class="gc" style="width:70px;text-align:left;font-size:8px" value="'+l[12]+'">':'<span class="gc-ro" style="font-size:8px;color:var(--t4)">'+l[12]+'</span>')+'</td>';
C+='<td>'+(ed&&l[13]!=='‚Äî'?'<input class="gc" style="width:78px;text-align:left;font-size:8px" value="'+l[13]+'">':'<span class="gc-ro" style="font-size:8px;color:var(--t4)">'+l[13]+'</span>')+'</td>';
C+='<td><span class="mb '+(isGL?l[11]==='ok'?'gl':'v':l[11])+'">'+l[10]+'</span></td></tr>'});
C+='</tbody></table></div>';

if(d.rc)C+='<div class="rc"><div class="rc-l">‚ö† Root Cause</div><div class="rc-t"><strong>Pattern:</strong> '+d.rc.p+'<br>'+d.rc.b+'<br><strong>Prediction:</strong> '+d.rc.pr+'<br><strong>Rec:</strong> '+d.rc.r+'</div></div>';
document.getElementById('WC').innerHTML=C;

/* RIGHT ‚Äî Decision */
let R='<div class="wt">‚ö° Decision Panel</div><div class="timeline">';
d.tl.forEach((s,i)=>{let cls=s===1?'done':s===2?'current':'';let icon=s===1?'‚úì':s===2?'‚óè':(i+1);if(i>0)R+='<div class="tl-line'+(s===1||d.tl[i-1]===1?' done':'')+'"></div>';R+='<div class="tl-step"><div class="tl-dot '+cls+'">'+icon+'</div><div class="tl-label '+(s===1?'done':s===2?'current':'')+'">'+d.tlLabels[i]+'</div></div>'});R+='</div>';
if(d.appr.needed)R+='<div class="appr-box needed"><div class="appr-title needed">‚ö† Approval Required</div><div class="appr-reason">'+d.appr.reason+'</div>'+(d.appr.who?'<div class="appr-who">'+d.appr.who+'</div>':'')+'</div>';
else R+='<div class="appr-box no"><div class="appr-title no">‚úì No Approval</div><div class="appr-reason">'+d.appr.reason+'</div></div>';
R+='<div class="save-group"><div class="btn-save" onclick="doSave()">üíæ Save Draft</div><div class="btn-submit '+d.submit.cls+'" onclick="doSubmit(\''+d.submit.cls+'\')">'+d.submit.label+'</div></div>';
if(d.acts.length||d.rsn){R+='<div class="agl">Route / Return / Reject</div>';d.acts.forEach(a=>{R+='<div class="btn '+a.c+'" onclick="doAct(\''+a.l+'\')"><span class="btn-i">'+a.i+'</span><span class="btn-t">'+a.l+'</span><span class="btn-o" style="background:var(--'+a.oc+')">'+a.o+'</span></div>'});if(d.rsn)R+='<select class="rsel">'+d.rsn.map(r=>'<option>'+r+'</option>').join('')+'</select>'}
R+='<div class="ai-r"><div class="ai-rl">ü§ñ AI</div><div class="ai-rt">'+d.ai+'</div></div><div class="bapi">'+d.bapi.replace(/\n/g,'<br>')+'</div>';
R+='<div class="act-legend"><span class="al-i" style="background:var(--greenBg);color:var(--green)">‚úî Post</span><span class="al-i" style="background:var(--orangeBg);color:var(--orange)">‚Üê Supplier</span><span class="al-i" style="background:var(--blueBg);color:var(--blue)">‚Üí Buyer</span><span class="al-i" style="background:var(--amberBg);color:var(--amber)">üè≠ GR</span><span class="al-i" style="background:var(--slateBg);color:var(--slate)">‚è∏ Hold</span><span class="al-i" style="background:var(--purpleBg);color:var(--purple)">‚Üë Esc</span><span class="al-i" style="background:var(--redBg);color:var(--red)">‚úó Rej</span></div>';
document.getElementById('WR').innerHTML=R;go('wb')}

function tTh(el){el.nextElementSibling.classList.toggle('open')}
function mwT(t){document.querySelectorAll('.mw-tab').forEach(e=>e.classList.remove('on'));document.querySelectorAll('.mw-p').forEach(e=>e.classList.remove('on'));event.currentTarget.classList.add('on');document.getElementById('P-'+t).classList.add('on')}
function chF(ch,el){document.querySelectorAll('.ch-card').forEach(p=>p.classList.remove('on'));el.classList.add('on');document.querySelectorAll('.ir').forEach(r=>{r.style.display=(ch==='all'||r.dataset.ch===ch)?'grid':'none'})}
function tF(tp,el){document.querySelectorAll('.fc').forEach(c=>c.classList.remove('on'));el.classList.add('on');document.getElementById('S-po').style.display=tp==='nonpo'?'none':'';document.getElementById('S-np').style.display=tp==='po'?'none':'';document.querySelectorAll('.ir').forEach(r=>{let s=tp==='all'||(tp==='po'&&r.dataset.tp==='po')||(tp==='nonpo'&&r.dataset.tp==='nonpo')||r.dataset.cf===tp;r.style.display=s?'grid':'none'})}
function sI(q){q=q.toLowerCase();document.querySelectorAll('.ir').forEach(r=>{r.style.display=r.textContent.toLowerCase().includes(q)?'grid':'none'})}
function doSave(){toast('üíæ Draft saved')}
function doSubmit(c){if(c==='disabled'){toast('‚ö† Cannot submit');return}if(c==='appr')toast('üì§ Submitted for Approval');else toast('‚úì Submitted to SAP');setTimeout(()=>go('mw'),1200)}
function doAct(l){if(l.includes('Supplier')||l.includes('Return'))toast('‚Üê Returned');else if(l.includes('Buyer'))toast('‚Üí Buyer');else if(l.includes('GR'))toast('üè≠ GR/Ops');else if(l.includes('Hold'))toast('‚è∏ Hold');else toast('‚Üë Escalated')}
function pfm(el,msg){el.textContent='‚úì Posted';el.style.background='var(--green)';el.style.color='#fff';toast(msg)}
function toast(m){let t=document.getElementById('toast');document.getElementById('tmsg').textContent=m;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),2500)}
</script>
</body>
</html>
